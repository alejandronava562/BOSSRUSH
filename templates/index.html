<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sustainability App - Start</title>
  <link rel="stylesheet" href="{{url_for('static', filename='styles.css')}}" />
</head>
<body>
  <main class="container">
    <section id="start_screen" class="card" aria-labelledby="title">
      <h1 id="title">EcoGuardian</h1>
      <p id="status" role="status" aria-live="polite"></p>

      <form id="startForm" novalidate>
        <div class="field">
          <label for="username">Username</label>
          <input
            id="username"
            name="username"
            type="text"
            required
            autocomplete="username"
            aria-required="true"
          />
        </div>

        <fieldset class="field">
          <legend>Difficulty</legend>
          <div class="difficulty-group" role="radiogroup" aria-required="true">
            <button type="button" class="difficulty" data-value="easy" role="radio" aria-checked="false">
              Easy
            </button>
            <button type="button" class="difficulty" data-value="medium" role="radio" aria-checked="false">
              Medium
            </button>
            <button type="button" class="difficulty" data-value="hard" role="radio" aria-checked="false">
              Hard
            </button>
          </div>
        </fieldset>

        <button id="startBtn" type="submit" disabled>
          Start
        </button>
      </form>
    </section>

    <!-- Loading Screen with Story -->
    <section id="loading_screen" class="card card-loading hidden" aria-hidden="true">
      <div class="loading-content">
        <div class="loading-icon">
          <div class="earth-spinner"></div>
        </div>
        <h2 id="loading_title">Preparing Your Mission...</h2>
        <div class="story-container">
          <p id="story_text" class="story-text"></p>
        </div>
        <div class="loading-progress">
          <div class="loading-bar">
            <div id="loading_bar_fill" class="loading-bar-fill"></div>
          </div>
          <p id="loading_status" class="loading-status">Initializing...</p>
        </div>
      </div>
    </section>

    <section id="game_screen" class="card card-game hidden" aria-hidden="true">
      <header class="game-header">
        <div class="game-title">
          <h2 id="game_title">Boss Rush</h2>
          <p id="progress_text" class="muted"></p>
        </div>
        <button id="restartBtn" type="button" class="secondary hidden">Restart</button>
      </header>

      <section class="hud">
        <div class="boss-panel">
          <img id="boss_image" class="boss-image" alt="Boss portrait" />
          <div class="boss-meta">
            <h3 id="boss_name">Boss</h3>
            <p id="boss_category" class="muted"></p>
            <div class="bar-row">
              <span class="bar-label">Boss HP</span>
              <div class="bar"><div id="boss_hp_bar" class="bar-fill boss"></div></div>
              <span id="boss_hp" class="bar-value"></span>
            </div>
          </div>
        </div>

        <div class="player-panel">
          <div class="bar-row">
            <span class="bar-label">Your HP</span>
            <div class="bar"><div id="player_hp_bar" class="bar-fill player"></div></div>
            <span id="player_hp" class="bar-value"></span>
          </div>
          <div class="player-stats">
            <div class="stat-item" style="display: none;">
              <span class="stat-icon">ğŸ›¡ï¸</span>
              <span class="stat-label">Shield:</span>
              <span id="player_shield" class="stat-value">0</span>
            </div>
            <div class="stat-item" style="display: none;">
              <span class="stat-icon">âš”ï¸</span>
              <span class="stat-label">Attack:</span>
              <span id="player_attack" class="stat-value">+0</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Activatable Item Bar -->
      <section id="item_bar" class="item-bar hidden" aria-label="Items">
        <button id="item_noodles" class="item-slot hidden" type="button" data-item="noodles" title="Organic Crispy Noodles: +3 Attack + 10% Crit">
          <span class="item-icon">ğŸœ</span>
          <span class="item-name">Noodles</span>
          <span id="item_noodles_count" class="item-charge">0</span>
        </button>
        <button id="item_aegis" class="item-slot hidden" type="button" data-item="aegis" title="Everbloom Aegis: Permanent 50% damage reduction">
          <span class="item-icon">ğŸ¥»</span>
          <span class="item-name">Aegis</span>
          <span id="item_aegis_count" class="item-charge">0</span>
        </button>
        <button id="item_spell" class="item-slot hidden" type="button" data-item="spell" title="Gateway Of Living Grace: 3-turn 50% defense + 30% attack">
          <span class="item-icon">ğŸª„</span>
          <span class="item-name">Spell</span>
          <span id="item_spell_count" class="item-charge">0</span>
        </button>
        <button id="item_eco_blaster" class="item-slot hidden" type="button" data-item="eco_blaster" title="Eco Blaster: Remove one wrong answer">
          <span class="item-icon">ğ’„‰</span>
          <span class="item-name">Blaster</span>
          <span id="item_eco_blaster_count" class="item-charge">0</span>
        </button>
      </section>

      <section class="scene">
        <p id="scene_text">...</p>
      </section>

      <section class="choices">
        <div id="choices" class="choices-grid" aria-label="Choices"></div>
        <p id="turn_feedback" role="status" aria-live="polite"></p>
        <p id="sustainability_fact" class="muted"></p>
      </section>
    </section>

    <!-- Reward Selection Modal -->
    <div id="reward_modal" class="modal hidden" aria-hidden="true">
      <div class="modal-content reward-modal">
        <div class="reward-header">
          <h2>ğŸ‰ Boss Defeated!</h2>
          <p id="reward_message">Choose your reward:</p>
        </div>
        <div id="reward_options" class="reward-options"></div>
      </div>
    </div>

    <!-- Victory Screen -->
    <div id="victory_screen" class="modal hidden" aria-hidden="true">
      <div class="modal-content endgame-modal victory-modal">
        <div class="endgame-icon">ğŸ†</div>
        <h2 class="endgame-title victory-title">Victory!</h2>
        <p id="victory_message" class="endgame-message">You defeated all the bosses with sustainable choices!</p>
        <p id="victory_stats" class="endgame-stats"></p>
        <p id="victory_fact" class="endgame-fact muted"></p>
        <button id="victoryRestartBtn" type="button" class="endgame-btn victory-btn">Play Again</button>
      </div>
    </div>

    <!-- Defeat Screen -->
    <div id="defeat_screen" class="modal hidden" aria-hidden="true">
      <div class="modal-content endgame-modal defeat-modal">
        <div class="endgame-icon">ğŸ’€</div>
        <h2 class="endgame-title defeat-title">Defeated!</h2>
        <p id="defeat_message" class="endgame-message">You ran out of HP. Try again and pick more sustainable choices!</p>
        <p id="defeat_stats" class="endgame-stats"></p>
        <p id="defeat_fact" class="endgame-fact muted"></p>
        <button id="defeatRestartBtn" type="button" class="endgame-btn defeat-btn">Try Again</button>
      </div>
    </div>

    <!-- Damage number overlay -->
    <div id="damage_overlay" class="damage-overlay" aria-hidden="true"></div>
  </main>

  <script src="{{url_for('static', filename='script.js')}}"></script>
</body>
</html>



